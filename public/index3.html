<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Client</title>
    <link rel="icon" href="images/icon.png">
</head>
<body>
    <h1>Phone Controller</h1>

    <script type="module">
        const ws = new WebSocket("https://mystery-history-9d9aa246ca8c.herokuapp.com");    // https://mystery-history-9d9aa246ca8c.herokuapp.com
                                                            // ws://localhost:8080
        

        ws.onopen = function() {
            console.log("Connected to WebSocket server");
            ws.send("Hello from HTML");
        };

        ws.onmessage = function(event) {
            if (event.data instanceof Blob) {
                // Convert Blob to text (UTF-8 encoding)
                var reader = new FileReader();
                reader.onload = function() {
                    var message = reader.result;
                    console.log("Received message:", message);  // Log the decoded message
                };
                reader.readAsText(event.data);  // Convert Blob to a string
            } else {
                console.log("Received message:", event.data);  // This handles text messages directly
            }
        };

        ws.onerror = function(error) {
            console.error("WebSocket Error: " + error);
        };

        ws.onclose = function() {
            console.log("WebSocket connection closed");
        };

        // Define the sendInput function
        function sendInput(command) {
            if (ws.readyState === WebSocket.OPEN) {
                ws.send(command);
                console.log("Sent: " + command);
            }
        }

        // Function to get query parameters
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Get the value of 'myVar' from the URL and set it to a new const (or use let)
        const newVarValue = getQueryParam('player');

        // If you want to update a const in the script (although const can't be reassigned), 
        // you should use 'let' or 'var' instead.
        let player = newVarValue;
        console.log('Updated variable:', player);

    </script>
</body>
</html>
